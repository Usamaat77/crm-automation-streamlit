{% extends "layout.html" %}

{% block content %}
<div class="card mb-4">
    <div class="card-header">
        <div class="d-flex justify-content-between align-items-center">
            <h4 class="mb-0">Upload Excel File</h4>
            <span class="badge bg-primary">Step 1 of 3</span>
        </div>
    </div>
    <div class="card-body">
        <p>Upload your Excel file containing the invoice data to update in the CRM system.</p>
        <p>The file should have columns for:</p>
        <ul>
            <li><strong>Booking No</strong> (with or without "SZ" prefix)</li>
            <li><strong>Supplier</strong> (as it appears in the CRM dropdown)</li>
            <li><strong>Actual Net Cost</strong> (the value to update)</li>
        </ul>

        <form action="/upload" method="post" enctype="multipart/form-data" class="mt-4">
            <div class="mb-3">
                <label for="file" class="form-label">Excel File</label>
                <input type="file" class="form-control" id="file" name="file" accept=".xlsx,.xls" required>
                <div class="form-text">Accepted formats: .xlsx, .xls</div>
            </div>
            <button type="submit" class="btn btn-primary">Upload</button>
        </form>
    </div>
</div>

<div class="card">
    <div class="card-header">
        <h4 class="mb-0">Example Excel Format</h4>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Booking No</th>
                        <th>Supplier</th>
                        <th>Actual Net Cost</th>
                        <th>Other Fields</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>SZ12345</td>
                        <td>Supplier A</td>
                        <td>500.00</td>
                        <td>Additional data...</td>
                    </tr>
                    <tr>
                        <td>67890</td>
                        <td>Supplier B</td>
                        <td>750.50</td>
                        <td>Additional data...</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="mt-3 mb-0 text-muted">Note: You can include additional columns in your Excel file; you'll select which columns to use in the next step.</p>
    </div>
</div>
{% endblock %}